---
layout: post
title: "三种Serdes接口中8B/10B解码器设计结果"
description: ""
category: "Tech"
tags: ["Verilog", "Paper"]
---
{% include JB/setup %}

根据SERDES协议要求完成了三种思路的解码器设计，并对其进行综合。
在相同的综合条件下针对设计面积额、时钟频率和功耗等进行比较。

三种解码器思路描述
==================

现在常见的解码器思路有两种，一是根据最初的经典文章描述的纯逻辑解码方法中描述的逻辑电路进行解码和差错控制，这里不再赘述。，二是使用CASE
STATEMENT描述的分块解码方法。
根据以上两种电路的优缺点，设计了第三种综合双方优势的解码方法。

经典逻辑法
----------

经典逻辑法是完全按照IBM文章中描述的逻辑电路进行解码和差错控制，这里不再赘述。
本设计代码用的是网上已有的代码，与文章中的描述基本一致，还添加了合理的差错控制代码。

分块查表法
----------

分块查表法，根据Actel文中描述的CASE
STATEMENT来进行解码，分为6B/5B部分和4B/3B部分。

由于制定的数据输入只会产生唯一对应的、最多两种的编码，这样就可以通过CASE条件的判断，准确的解出正确的码字。

这种解码器的差错控制也是由其他的模块来完成，解码表部分只负责解码。

综合方法
--------

本设计主要的思路也是分块解码，但不同于上一种方法。
设计考虑了无论是经典逻辑法还是分块查表法，都要对当前码字进行Disparty的判断，从而可以判断出收到的码字是否存在误码。在编码过程中，Disparty是作为重要的编码依据，正因为要保证Disparty的正常，才需要对某些数据进行不同的编码。

所以，在解码中，既然不可避免的要生成Disparty信息，就对他进行利用。
由Disparty模块输出6B和4B的Disparty
Positive的信号，输入6B/5B和4B/3B解码模块。
在解码模块中如果6B和4B的Disparty为Positive，就对6B和4B取反。
这样就可以对解码表进行化简，避免了对Disparty为Negtive的码字的解码。
最后通过逻辑表达式的化简对每一位进行逻辑输出，从而获得正确的解码结果。

Synopsys Design Compiler
========================

尝试使用Windows版本的DC，结果发现无法使用，于是安装了Linux版本的DC。
初次使用DC也发现了很多问题和不明白的地方，但是大概能够理解综合软件的使用。

安装
----

综合网上信息，成功在CentOS
5上安装了2008版本的DC，具体安装方法及安装软件包已打包保存，供以后使用。

参数设置
--------

芯片综合不同于FPGA，FPGA的资源是整合在已有芯片上的，每一款固定的芯片都有其自己固定的资源。
而芯片综合则要考虑更多的信息。

### 工艺库

本次综合使用的是网络上找到的SMIC的180纳米数字设计工艺库。

一个工艺库对于Synopsys DC软件的文件有三种，分别是fast、slow和typical。
这三种分别代表三种不同工作环境下器件的工作效果，fast即最好的工作环境，slow即最差的工作环境，typical即典型的环境。
一般在综合中要对最好和最坏的情况进行分析，所以一般使用fast和slow，处于两者之间的结果基本上就是芯片的工作范围。

### 设计环境

#### 工作条件

一般工作条件就是工作温度等等的数据，这些一般都集成在工艺库文件中，不需要特别指定。

#### 线负载模型

在实际电路中，导线都具有一定的电阻和电容，使得信号在导线上传播时均有一定的延时。
在深亚微米设计中，导线互连延时对信号造成的影响是不容忽略的。
这些信息也已经集成在工艺库文件中，只要通过指令对其选择即可。

#### 系统接口特性

电路与外部系统的接口特性包括以下几个方面：输入端口的驱动特性、输入和输出端
口的负载、输出端口的扇出负载。
这些信息一般都有典型值，所以在设置中也主要采用典型值。

### 设计规则约束

#### 时序约束

主要定义的是时钟的周期，上升沿、下降沿的变化范围。
以及输入输出接口的时延。

#### 面积约束

一般都设置为0，以获得最小面积。

综合
----

综合过程一般分为四步：设定工艺库、读入RTL设计、进行综合、输出报告。
Linux下的DC可以通过GUI界面和命令行进行综合。
读入设计后可以通过GUI观察详细的门电路级电路，使用的器件既为器件库中所包含的器件。

综合完成后就可以得到详细的综合报告。
比较有价值的即面积报告、时序报告和功耗报告。
其中面积报告可以将每个子模块占用的面积总结出来，单位为平方微米（um<sup>2</sup>）；
时序报告会找到耗时最长的路径以表示电路最高的工作速度，单位为纳秒(ns)；
功耗报告即整体的功率损耗，单位为纳瓦(nW)。

综合结果比较
============

下表详细比较了几种设计，其中括号里面的比例均为和新设计比较的比例，即视新设计具体之为100%。

name  | Classic | Actel  | New
------|-------:|------:|------:
RD Cal Area(um<sup>2</sup>) | | 665(99%) | 675
4B/3B Area(um<sup>2</sup>) | | 369(148%) | 249
6B/5B Area(um<sup>2</sup>) | | 1184(172%) | 688
Sum Area(um<sup>2</sup>) | 1570(97%) | 2218(138%) | 1612
Total Cell Area(um<sup>2</sup>) | 1716(98%) | 2657(151%) | 1759
Total Area(um<sup>2</sup>| 16836(107%)| 24497(156%)| 15666
Timing(ns) | 8.16 | 9.97 | 9.54
Time Used(ns) | 5.84 | 4.03 | 4.46
Frequency(MHz) | 171.2(76%) | 248.1(111%)| 224.2
Cell Internal Power(nW) | 22.6(83%) | 31.0(114%) | 27.2
Net Switing Power(nW) | 42.8(80%) | 50.1(94%) | 53.3
Total Dynamic Power(nW) | 65.4(81%) | 81.1(101%) | 80.5

### 相较于Actel方法

新设计在频率上有11%的减少，但是在面积上，无论是单元面积还是总面积都减少了近50%的提升。
两者在功耗上几乎相同。

### 相较于传统方法

新设计在频率上有近25%的提升，在单元面积上几乎相同，在总面积上减少了7%。
但是在功耗上有近20%的差距。

总结
====

在整个代码编写及综合过程中的一些总结：

1.  电路综合要注意的是RTL代码必须是可综合的，不然会报错，具体可综合代码有哪些特点需要查看相关资料。

2.  综合软件需要有一定的了解才方便使用，有一些新的概念（比如说线负载）需要了解。

3.  综合的过程其实是对电路再一次规划的过程，可以通过综合报告获知电路的短板在哪里，便于修改。

4.  要综合出面积比较小的代码需要多用组合逻辑来实现功能，要综合出速度比较快的电路需要多使用CASE语句。

5.  数字电路设计其实是面积、频率和功耗三方面的角力，设计时要尽量使各方面达到更优。
